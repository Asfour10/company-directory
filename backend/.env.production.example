# Production Environment Variables Template
# Copy this file to .env.production and fill in actual values
# NEVER commit .env.production to version control!

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

NODE_ENV=production
PORT=3000
API_URL=https://api.yourdomain.com
FRONTEND_URL=https://app.yourdomain.com

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL Connection
# Format: postgresql://USER:PASSWORD@HOST:PORT/DATABASE?sslmode=require
DATABASE_URL="postgresql://app_user:CHANGE_ME@db-host:5432/company_directory?sslmode=require&connection_limit=20&pool_timeout=20"

# For AWS RDS:
# DATABASE_URL="postgresql://app_user:PASSWORD@company-directory-prod.xxxxx.us-east-1.rds.amazonaws.com:5432/company_directory?sslmode=require"

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================

# Redis Connection
# Format: redis://[:PASSWORD@]HOST:PORT/DATABASE
REDIS_URL="redis://:CHANGE_ME@redis-host:6379/0"

# For AWS ElastiCache:
# REDIS_URL="redis://company-directory-prod.xxxxx.cache.amazonaws.com:6379/0"

# Redis Configuration
REDIS_TTL_SESSION=28800  # 8 hours in seconds
REDIS_TTL_CACHE=300      # 5 minutes in seconds
REDIS_TTL_TENANT=3600    # 1 hour in seconds

# ============================================================================
# SECURITY SECRETS
# ============================================================================

# JWT Secret (Generate with: openssl rand -base64 64)
JWT_SECRET="CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64"

# JWT Configuration
JWT_EXPIRES_IN="8h"
JWT_REFRESH_EXPIRES_IN="7d"

# Session Secret (Generate with: openssl rand -base64 64)
SESSION_SECRET="CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_BASE64_64"

# Encryption Key for sensitive data (Generate with: openssl rand -hex 32)
ENCRYPTION_KEY="CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_HEX_32"

# ============================================================================
# OBJECT STORAGE (AWS S3 or Compatible)
# ============================================================================

# AWS S3 Configuration
AWS_REGION="us-east-1"
AWS_ACCESS_KEY_ID="CHANGE_ME"
AWS_SECRET_ACCESS_KEY="CHANGE_ME"
S3_BUCKET_NAME="company-directory-prod-files"
S3_ENDPOINT=""  # Leave empty for AWS S3, set for S3-compatible services

# CloudFront CDN (optional)
CDN_URL="https://cdn.yourdomain.com"

# File Upload Limits
MAX_FILE_SIZE=2097152  # 2MB in bytes
ALLOWED_FILE_TYPES="image/jpeg,image/png,image/gif,image/webp"

# ============================================================================
# EMAIL SERVICE (SendGrid, AWS SES, etc.)
# ============================================================================

# Email Provider (sendgrid, ses, smtp)
EMAIL_PROVIDER="sendgrid"

# SendGrid Configuration
SENDGRID_API_KEY="CHANGE_ME"
SENDGRID_FROM_EMAIL="noreply@yourdomain.com"
SENDGRID_FROM_NAME="Company Directory"

# AWS SES Configuration (if using SES)
# AWS_SES_REGION="us-east-1"
# AWS_SES_FROM_EMAIL="noreply@yourdomain.com"

# SMTP Configuration (if using SMTP)
# SMTP_HOST="smtp.example.com"
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER="CHANGE_ME"
# SMTP_PASSWORD="CHANGE_ME"

# ============================================================================
# SSO CONFIGURATION (Per Tenant)
# ============================================================================

# Azure AD
AZURE_AD_CLIENT_ID=""
AZURE_AD_CLIENT_SECRET=""
AZURE_AD_TENANT_ID=""
AZURE_AD_CALLBACK_URL="https://api.yourdomain.com/api/auth/sso/azure/callback"

# Google Workspace
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""
GOOGLE_CALLBACK_URL="https://api.yourdomain.com/api/auth/sso/google/callback"

# Okta
OKTA_DOMAIN=""
OKTA_CLIENT_ID=""
OKTA_CLIENT_SECRET=""
OKTA_CALLBACK_URL="https://api.yourdomain.com/api/auth/sso/okta/callback"

# ============================================================================
# BILLING & SUBSCRIPTIONS (Optional - Stripe)
# ============================================================================

STRIPE_SECRET_KEY=""
STRIPE_PUBLISHABLE_KEY=""
STRIPE_WEBHOOK_SECRET=""
STRIPE_PRICE_ID_BASIC=""
STRIPE_PRICE_ID_PROFESSIONAL=""
STRIPE_PRICE_ID_ENTERPRISE=""

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

# Prometheus Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Log Level (error, warn, info, debug)
LOG_LEVEL="info"

# Sentry Error Tracking (optional)
SENTRY_DSN=""
SENTRY_ENVIRONMENT="production"

# ============================================================================
# RATE LIMITING
# ============================================================================

# Global rate limit (requests per 15 minutes)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000

# Auth rate limit (login attempts per 15 minutes)
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# API rate limit (requests per minute per user)
API_RATE_LIMIT_WINDOW_MS=60000
API_RATE_LIMIT_MAX_REQUESTS=100

# ============================================================================
# CORS CONFIGURATION
# ============================================================================

# Allowed origins (comma-separated)
CORS_ORIGINS="https://app.yourdomain.com,https://yourdomain.com"

# Allow credentials
CORS_CREDENTIALS=true

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/disable features
ENABLE_SSO=true
ENABLE_SCIM=true
ENABLE_BILLING=false
ENABLE_ANALYTICS=true
ENABLE_AUDIT_LOGS=true
ENABLE_CUSTOM_FIELDS=true
ENABLE_BULK_IMPORT=true
ENABLE_ORG_CHART=true

# ============================================================================
# DATA RETENTION & GDPR
# ============================================================================

# Audit log retention (days)
AUDIT_LOG_RETENTION_DAYS=730  # 2 years

# Session retention (days)
SESSION_RETENTION_DAYS=30

# Analytics retention (days)
ANALYTICS_RETENTION_DAYS=90

# Data deletion grace period (days)
DATA_DELETION_GRACE_PERIOD_DAYS=30

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Database connection pool
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=20
DATABASE_POOL_TIMEOUT=20000

# Request timeout (milliseconds)
REQUEST_TIMEOUT=30000

# Body parser limits
BODY_LIMIT="10mb"
JSON_LIMIT="10mb"

# ============================================================================
# SECURITY HEADERS
# ============================================================================

# Content Security Policy
CSP_DIRECTIVES="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://api.yourdomain.com"

# HSTS Max Age (seconds)
HSTS_MAX_AGE=31536000

# ============================================================================
# HEALTH CHECKS
# ============================================================================

# Health check endpoints
HEALTH_CHECK_PATH="/health"
READY_CHECK_PATH="/ready"

# Health check timeout (milliseconds)
HEALTH_CHECK_TIMEOUT=5000

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================

# Backup S3 bucket (for database backups)
BACKUP_S3_BUCKET="company-directory-prod-backups"
BACKUP_RETENTION_DAYS=30

# ============================================================================
# ALERTING
# ============================================================================

# Slack webhook for alerts (optional)
SLACK_WEBHOOK_URL=""
SLACK_CHANNEL="#alerts"

# PagerDuty integration (optional)
PAGERDUTY_INTEGRATION_KEY=""

# Email alerts
ALERT_EMAIL="ops@yourdomain.com"

# ============================================================================
# TENANT CONFIGURATION
# ============================================================================

# Default tenant settings
DEFAULT_TENANT_NAME="Default Organization"
DEFAULT_TENANT_SUBDOMAIN="app"

# Multi-tenancy mode (subdomain, path, header)
TENANCY_MODE="subdomain"

# ============================================================================
# SEARCH CONFIGURATION
# ============================================================================

# Search result limit
SEARCH_RESULT_LIMIT=100

# Search cache TTL (seconds)
SEARCH_CACHE_TTL=300

# Search debounce delay (milliseconds)
SEARCH_DEBOUNCE_MS=300

# ============================================================================
# NOTES
# ============================================================================

# Security Checklist:
# [ ] All CHANGE_ME values replaced with actual secrets
# [ ] All secrets generated with proper entropy
# [ ] Database password is strong (16+ characters)
# [ ] JWT_SECRET is at least 256 bits
# [ ] ENCRYPTION_KEY is exactly 32 bytes (64 hex characters)
# [ ] CORS_ORIGINS set to actual production domains
# [ ] SSL/TLS enabled for all connections
# [ ] This file is NOT committed to version control
# [ ] Secrets are stored in secure secret manager
# [ ] Secrets are rotated every 90 days

# Generation Commands:
# JWT_SECRET: openssl rand -base64 64
# SESSION_SECRET: openssl rand -base64 64
# ENCRYPTION_KEY: openssl rand -hex 32
# Strong Password: openssl rand -base64 24
